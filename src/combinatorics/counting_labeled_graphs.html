<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<!--?title Counting labeled graphs -->
<h1 id="counting-labeled-graphs">Counting labeled graphs</h1>
<h2 id="labeled-graphs">Labeled graphs</h2>
<p>Let the number of vertices in a graph be <span class="math inline"><em>n</em></span>. We have to compute the number <span class="math inline"><em>G</em><sub><em>n</em></sub></span> of labeled graphs with <span class="math inline"><em>n</em></span> vertices (labeled means that the vertices are marked with the numbers from <span class="math inline">1</span> to <span class="math inline"><em>n</em></span>). The edges of the graphs are considered undirected, and loops and multiple edges are forbidden.</p>
<p>We consider the set of all possible edges of the graph. For each edge <span class="math inline">(<em>i</em>, <em>j</em>)</span> we can assume that <span class="math inline"><em>i</em> &lt; <em>j</em></span> (because the graph is undirected, and there are no loops). Therefore the set of all edges has the cardinality <span class="math inline">$\binom{n}{2}$</span>, i.e. <span class="math inline">$\frac{n(n-1)}{2}$</span>.</p>
<p>Since any labeled graph is uniquely determined by its edges, the number of labeled graphs with <span class="math inline"><em>n</em></span> vertices is equal to: <br /><span class="math display">$$G_n = 2^{\frac{n(n-1)}{2}}$$</span><br /></p>
<h2 id="connected-labeled-graphs">Connected labeled graphs</h2>
<p>Here, we additionally impose the restriction that the graph has to be connected.</p>
<p>Let's denote the required number of connected graphs with <span class="math inline"><em>n</em></span> vertices as <span class="math inline"><em>C</em><sub><em>n</em></sub></span>.</p>
<p>We will first discuss how many <strong>disconnected</strong> graphs exists. Then the number of connected graphs will be <span class="math inline"><em>G</em><sub><em>n</em></sub></span> minus the number of disconnected graphs. Even more, we will count the number of <strong>disconnected, rooted graphs</strong>.A rooted graph is a graph, where we emphasize one vertex by labeling it as root. Obviously we have <span class="math inline"><em>n</em></span> possibilities to root a graph with <span class="math inline"><em>n</em></span> labeled vertices, therefore we will need to divide the number of disconnected rooted graphs by <span class="math inline"><em>n</em></span> at the end to get the number of disconnected graphs.</p>
<p>The root vertex will appear in a connected component of size <span class="math inline">1, …<em>n</em> − 1</span>. There are <span class="math inline">$k \binom{n}{k} C_k G_{n-k}$</span> graphs such that the root vertex is in a connected component with <span class="math inline"><em>k</em></span> vertices (there are <span class="math inline">$\binom{n}{k}$</span> ways to choose <span class="math inline"><em>k</em></span> vertices for the component, these are connected in one of <span class="math inline"><em>C</em><sub><em>k</em></sub></span> ways, the root vertex can be any of the <span class="math inline"><em>k</em></span> vertices, and the remainder <span class="math inline"><em>n</em> − <em>k</em></span> vertices can be connected/disconnected in any way, which gives a factor of <span class="math inline"><em>G</em><sub><em>n</em> − <em>k</em></sub></span>). Therefore the number of disconnected graphs with <span class="math inline"><em>n</em></span> vertices is: <br /><span class="math display">$$\frac{1}{n} \sum_{k=1}^{n-1} k \binom{n}{k} C_k G_{n-k}$$</span><br /> And finally the number of connected graphs is: <br /><span class="math display">$$C_n = G_n - \frac{1}{n} \sum_{k=1}^{n-1} k \binom{n}{k} C_k G_{n-k}$$</span><br /></p>
<h2 id="labeled-graphs-with-k-connected-components">Labeled graphs with <span class="math inline"><em>k</em></span> connected components</h2>
<p>Based on the formula from the previous section, we will learn how to count the number of labeled graphs with <span class="math inline"><em>n</em></span> vertices and <span class="math inline"><em>k</em></span> connected components.</p>
<p>This number can be computed using dynamic programming. We will compute <span class="math inline"><em>D</em>[<em>i</em>][<em>j</em>]</span> - the number of labeled graphs with <span class="math inline"><em>i</em></span> vertices and <span class="math inline"><em>j</em></span> components - for each <span class="math inline"><em>i</em> ≤ <em>n</em></span> and <span class="math inline"><em>j</em> ≤ <em>k</em></span>.</p>
<p>Let's discuss how to compute the next element <span class="math inline"><em>D</em>[<em>n</em>][<em>k</em>]</span> if we already know the previous values. We use a common approach, we take the last vertex (index <span class="math inline"><em>n</em></span>). This vertex belongs to some component. If the size of this component be <span class="math inline"><em>s</em></span>, then there are <span class="math inline">$\binom{n-1}{s-1}$</span> ways to choose such a set of vertices, and <span class="math inline"><em>C</em><sub><em>s</em></sub></span> ways to connect them.After removing this component from the graph we have <span class="math inline"><em>n</em> − <em>s</em></span> remaining vertices with <span class="math inline"><em>k</em> − 1</span> connected components. Therefore we obtain the following recurrence relation: <br /><span class="math display">$$D[n][k] = \sum_{s=1}^{n} \binom{n-1}{s-1} C_s D[n-s][k-1]$$</span><br /></p>
</body>
</html>
