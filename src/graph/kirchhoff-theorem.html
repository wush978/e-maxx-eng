<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<!--?title Kirchhoff's Theorem -->
<h1 id="kirchhoffs-theorem.-finding-the-number-of-spanning-trees">Kirchhoff's theorem. Finding the number of spanning trees</h1>
<p>Problem: You are given a connected undirected graph (with possible multiple edges) represented using an adjacency matrix. Find the number of different spanning trees of this graph.</p>
<p>The following formula was proven by Kirchhoff in 1847.</p>
<h2 id="kirchhoffs-matrix-tree-theorem">Kirchhoff's matrix tree theorem</h2>
<p>Let <span class="math inline"><em>A</em></span> be the adjacency matrix of the graph: <span class="math inline"><em>A</em><sub><em>u</em>, <em>v</em></sub></span> is the number of edges between <span class="math inline"><em>u</em></span> and <span class="math inline"><em>v</em></span>. Let <span class="math inline"><em>D</em></span> be the degree matrix of the graph: a diagonal matrix with <span class="math inline"><em>D</em><sub><em>u</em>, <em>u</em></sub></span> being the degree of vertex <span class="math inline"><em>u</em></span> (including multiple edges and loops - edges which connect vertex <span class="math inline"><em>u</em></span> with itself).</p>
<p>The Laplacian matrix of the graph is defined as <span class="math inline"><em>L</em> = <em>D</em> − <em>A</em></span>. According to Kirchhoff's theorem, all cofactors of this matrix are equal to each other, and they are equal to the number of spanning trees of the graph. The <span class="math inline">(<em>i</em>, <em>j</em>)</span> cofactor of a matrix is the product of <span class="math inline">( − 1)<sup><em>i</em> + <em>j</em></sup></span> with the determinant of the matrix that you get after removing the <span class="math inline"><em>i</em></span>-th row and <span class="math inline"><em>j</em></span>-th column. So you can, for example, delete the last row and last column of the matrix <span class="math inline"><em>L</em></span>, and the absolute value of the determinant of the resulting matrix will give you the number of spanning trees.</p>
<p>The determinant of the matrix can be found in <span class="math inline"><em>O</em>(<em>N</em><sup>3</sup>)</span> by using the <a href="./linear_algebra/determinant-gauss.html">Gaussian method</a>.</p>
<p>The proof of this theorem is quite difficult and is not presented here; for an outline of the proof and variations of the theorem for graphs without multiple edges and for directed graphs refer to <a href="https://en.wikipedia.org/wiki/Kirchhoff%27s_theorem">Wikipedia</a>.</p>
<h2 id="relation-to-kirchhoffs-circuit-laws">Relation to Kirchhoff's circuit laws</h2>
<p>Kirchhoff's matrix tree theorem and Kirchhoff's laws for electrical circuit are related in a beautiful way. It is possible to show (using Ohm's law and Kirchhoff's first law) that resistance <span class="math inline"><em>R</em><sub><em>i</em><em>j</em></sub></span> between two points of the circuit <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> is</p>
<p><br /><span class="math display">$$R_{ij} = \frac{ \left| L^{(i,j)} \right| }{ | L^j | }.$$</span><br /></p>
<p>Here the matrix <span class="math inline"><em>L</em></span> is obtained from the matrix of inverse resistances <span class="math inline"><em>A</em></span> (<span class="math inline"><em>A</em><sub><em>i</em>, <em>j</em></sub></span> is inverse of the resistance of the conductor between points <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span>) using the procedure described in Kirchhoff's matrix tree theorem. <span class="math inline"><em>T</em><sup><em>j</em></sup></span> is the matrix with row and column <span class="math inline"><em>j</em></span> removed, <span class="math inline"><em>T</em><sup>(<em>i</em>, <em>j</em>)</sup></span> is the matrix with two rows and two columns <span class="math inline"><em>i</em></span> and <span class="math inline"><em>j</em></span> removed.</p>
<p>Kirchhoff's theorem gives this formula geometric meaning.</p>
<h2 id="practice-problems">Practice Problems</h2>
<ul>
<li><a href="https://www.codechef.com/problems/STARROAD">CODECHEF: Roads in Stars</a></li>
<li><a href="http://www.spoj.com/problems/KPMAZE/">SPOJ: Maze</a></li>
</ul>
</body>
</html>
