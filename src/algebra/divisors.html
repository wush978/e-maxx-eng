<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<!--?title Number of divisors / sum of divisors -->
<h1 id="number-of-divisors-sum-of-divisors">Number of divisors / sum of divisors</h1>
<p>In this article we discuss how to compute the number of divisors <span class="math inline"><em>d</em>(<em>n</em>)</span> and the sum of divisors <span class="math inline"><em>σ</em>(<em>n</em>)</span> of a given number <span class="math inline"><em>n</em></span>.</p>
<h2 id="number-of-divisors">Number of divisors</h2>
<p>It should be obvious that the prime factorization of a divisor <span class="math inline"><em>d</em></span> has to be a subset of the prime factorization of <span class="math inline"><em>n</em></span>, e.g. <span class="math inline">6 = 2 ⋅ 3</span> is a divisor of <span class="math inline">60 = 2<sup>2</sup> ⋅ 3 ⋅ 5</span>. So we only need to find all different subsets of the prime factorization of <span class="math inline"><em>n</em></span>.</p>
<p>Usually the number of subsets is <span class="math inline">2<sup><em>x</em></sup></span> for a set with <span class="math inline"><em>x</em></span> elements. However this is no longer true, if there are repeated elements in the set. In our case some prime factors may appear multiple times in the prime factorization of <span class="math inline"><em>n</em></span>.</p>
<p>If a prime factor <span class="math inline"><em>p</em></span> appears <span class="math inline"><em>e</em></span> times in the prime factorization of <span class="math inline"><em>n</em></span>, then we can use the factor <span class="math inline"><em>p</em></span> up to <span class="math inline"><em>e</em></span> times in the subset. Which means we have <span class="math inline"><em>e</em> + 1</span> choices.</p>
<p>Therefore if the prime factorization of <span class="math inline"><em>n</em></span> is <span class="math inline"><em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup> ⋅ <em>p</em><sub>2</sub><sup><em>e</em><sub>2</sub></sup>⋯<em>p</em><sub><em>k</em></sub><sup><em>e</em><sub><em>k</em></sub></sup></span>, where <span class="math inline"><em>p</em><sub><em>i</em></sub></span> are distinct prime numbers, then the number of divisors is: <br /><span class="math display"><em>d</em>(<em>n</em>)=(<em>e</em><sub>1</sub> + 1)⋅(<em>e</em><sub>2</sub> + 1)⋯(<em>e</em><sub><em>k</em></sub> + 1)</span><br /></p>
<p>A way of thinking about it is the following:</p>
<ul>
<li><p>If there is only one distinct prime divisor <span class="math inline"><em>n</em> = <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup></span>, then there are obviously <span class="math inline"><em>e</em><sub>1</sub> + 1</span> divisors (<span class="math inline">1, <em>p</em><sub>1</sub>, <em>p</em><sub>1</sub><sup>2</sup>, …, <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup></span>).</p></li>
<li><p>If there are two distinct prime divisors <span class="math inline"><em>n</em> = <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup> ⋅ <em>p</em><sub>2</sub><sup><em>e</em><sub>2</sub></sup></span>, then you can arrange all divisors in form of a tabular. <br /><span class="math display">$$\begin{array}{c|ccccc}
&amp; 1 &amp; p_2 &amp; p_2^2 &amp; \dots &amp; p_2^{e_2} \\\\
\hline
1 &amp; 1 &amp; p_2 &amp; p_2^2 &amp; \dots &amp; p_2^{e_2} \\\\
p_1 &amp; p_1 &amp; p_1 \cdot p_2 &amp; p_1 \cdot p_2^2 &amp; \dots &amp; p_1 \cdot p_2^{e_2} \\\\
p_1^2 &amp; p_1^2 &amp; p_1^2 \cdot p_2 &amp; p_1^2 \cdot p_2^2 &amp; \dots &amp; p_1^2 \cdot p_2^{e_2} \\\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\\\
p_1^{e_1} &amp; p_1^{e_1} &amp; p_1^{e_1} \cdot p_2 &amp; p_1^{e_1} \cdot p_2^2 &amp; \dots &amp; p_1^{e_1} \cdot p_2^{e_2} \\\\
\end{array}$$</span><br /> So the number of divisors is trivially <span class="math inline">(<em>e</em><sub>1</sub> + 1)⋅(<em>e</em><sub>2</sub> + 1)</span>.</p></li>
<li><p>A similar argument can be made if there are more then two distinct prime factors.</p></li>
</ul>
<h2 id="sum-of-divisors">Sum of divisors</h2>
<p>We can use the same argument of the previous section.</p>
<ul>
<li><p>If there is only one distinct prime divisor <span class="math inline"><em>n</em> = <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup></span>, then the sum is: <br /><span class="math display">$$1 + p_1 + p_1^2 + \dots + p_1^{e_1} = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1}$$</span><br /></p></li>
<li><p>If there are two distinct prime divisors <span class="math inline"><em>n</em> = <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup> ⋅ <em>p</em><sub>2</sub><sup><em>e</em><sub>2</sub></sup></span>, then we can make the same table as before. The only difference is that now we now want to compute the sum instead of counting the elements. It is easy to see, that the sum of each combination can be expressed as: <br /><span class="math display">(1+<em>p</em><sub>1</sub>+<em>p</em><sub>1</sub><sup>2</sup>+…+<em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup>) ⋅ (1+<em>p</em><sub>2</sub>+<em>p</em><sub>2</sub><sup>2</sup>+…+<em>p</em><sub>2</sub><sup><em>e</em><sub>2</sub></sup>)</span><br /> <br /><span class="math display">$$ = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot \frac{p_2^{e_2 + 1} - 1}{p_2 - 1}$$</span><br /></p></li>
<li><p>In general, for <span class="math inline"><em>n</em> = <em>p</em><sub>1</sub><sup><em>e</em><sub>1</sub></sup> ⋅ <em>p</em><sub>2</sub><sup><em>e</em><sub>2</sub></sup>⋯<em>p</em><sub><em>k</em></sub><sup><em>e</em><sub><em>k</em></sub></sup></span> we receive the formula: <br /><span class="math display">$$\sigma(n) = \frac{p_1^{e_1 + 1} - 1}{p_1 - 1} \cdot \frac{p_2^{e_2 + 1} - 1}{p_2 - 1} \cdots \frac{p_k^{e_k + 1} - 1}{p_k - 1}$$</span><br /></p></li>
</ul>
<h2 id="multiplicative-functions">Multiplicative functions</h2>
<p>A multiplicative functions is a function <span class="math inline"><em>f</em>(<em>x</em>)</span> which satisfies <br /><span class="math display"><em>f</em>(<em>a</em> ⋅ <em>b</em>)=<em>f</em>(<em>a</em>)⋅<em>f</em>(<em>b</em>)</span><br /> if <span class="math inline"><em>a</em></span> and <span class="math inline"><em>b</em></span> are coprime.</p>
<p>Both <span class="math inline"><em>d</em>(<em>n</em>)</span> and <span class="math inline"><em>σ</em>(<em>n</em>)</span> are multiplicative functions.</p>
<p>Multiplicative functions have a huge variety of interesting properties, which can be very useful in number theory problems. For instance the Dirichlet convolution of two multiplicative functions is also multiplicative.</p>
<h2 id="practice-problems">Practice Problems</h2>
<ul>
<li><a href="https://www.spoj.com/problems/COMDIV/">SPOJ - COMDIV</a></li>
<li><a href="https://www.spoj.com/problems/DIVSUM/">SPOJ - DIVSUM</a></li>
<li><a href="https://www.spoj.com/problems/DIVSUM2/">SPOJ - DIVSUM2</a></li>
</ul>
</body>
</html>
