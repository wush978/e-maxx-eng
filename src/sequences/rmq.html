<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<!--?title Range Minimum Query -->
<h1 id="range-minimum-query">Range Minimum Query</h1>
<p>You are given an array <span class="math inline"><em>A</em>[1..<em>N</em>]</span>. You have to answer incoming queries of the form <span class="math inline">(<em>L</em>, <em>R</em>)</span>, which ask to find the minimum element in array <span class="math inline"><em>A</em></span> between positions <span class="math inline"><em>L</em></span> and <span class="math inline"><em>R</em></span> inclusive.</p>
<p>RMQ can appear in problems directly or can be applied in some other tasks, e.g. the <a href="../graph/lca.html">Lowest Common Ancestor</a> problem.</p>
<h2 id="solution">Solution</h2>
<p>There are lots of possible approaches and data structures that you can use to solve the RMQ task.</p>
<p>The ones that are explained on this site are listed below.</p>
<p>First the approaches that allow modifications to the array between answering queries.</p>
<ul>
<li><a href="../data_structures/sqrt_decomposition.html">Sqrt-decomposition</a> - answers each query in <span class="math inline">$O(\sqrt{N})$</span>, preprocessing done in <span class="math inline"><em>O</em>(<em>N</em>)</span>. Pros: a very simple data structure. Cons: worse complexity.</li>
<li><a href="../data_structures/segment_tree.html">Segment tree</a> - answers each query in <span class="math inline"><em>O</em>(log<em>N</em>)</span>, preprocessing done in <span class="math inline"><em>O</em>(<em>N</em>)</span>. Pros: good time complexity. Cons: larger amount of code compared to the other data structures.</li>
<li><a href="../data_structures/fenwick.html">Fenwick tree</a> - answers each query in <span class="math inline"><em>O</em>(log<em>N</em>)</span>, preprocessing done in <span class="math inline"><em>O</em>(<em>N</em>log<em>N</em>)</span>. Pros: the shortest code, good time complexity. Cons: Fenwick tree can only be used for queries with <span class="math inline"><em>L</em> = 1</span>, so it is not applicable to many problems.</li>
</ul>
<p>And here are the approaches that only work on static arrays, i.e. it is not possible to change a value in the array without recomputing the complete data structure.</p>
<ul>
<li><a href="../data_structures/sparse-table.html">Sparse Table</a> - answers each query in <span class="math inline"><em>O</em>(1)</span>, preprocessing done in <span class="math inline"><em>O</em>(<em>N</em>log<em>N</em>)</span>. Pros: simple data structure, excellent time complexity.</li>
<li><a href="../data_structures/sqrt-tree.html">Sqrt Tree</a> - answers queries in <span class="math inline"><em>O</em>(1)</span>, preprocessing done in <span class="math inline"><em>O</em>(<em>N</em>loglog<em>N</em>)</span>. Pros: fast. Cons: Complicated to implement.</li>
<li><a href="../data_structures/disjoint_set_union.html#arpa">Disjoint Set Union / Arpa's Trick</a> - answers queries in <span class="math inline"><em>O</em>(1)</span>, preprocessing in <span class="math inline"><em>O</em>(<em>n</em>)</span>. Pros: short, fast. Cons: only works if all queries are known in advance, i.e. only supports off-line processing of the queries.</li>
<li><a href="../graph/rmq_linear.html">Cartesian Tree</a> and <a href="../graph/lca_farachcoltonbender.html">Farach-Colton and Bender algorithm</a> - answers queries in <span class="math inline"><em>O</em>(1)</span>, preprocessing in <span class="math inline"><em>O</em>(<em>n</em>)</span>. Pros: optimal complexity. Cons: large amount of code.</li>
</ul>
<p>Note: Preprocessing is the preliminary processing of the given array by building the corresponding data structure for it.</p>
<h2 id="practice-problems">Practice Problems</h2>
<ul>
<li><a href="http://www.spoj.com/problems/RMQSQ/">SPOJ: Range Minimum Query</a></li>
<li><a href="https://www.codechef.com/problems/FRMQ">CODECHEF: Chef And Array</a></li>
</ul>
</body>
</html>
